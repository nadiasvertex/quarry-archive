quarry is a python package that can archive e-mails by downloading them from an IMAP server.

The e-mails are saved in RFC822 format in an sqlite database, indexed by header attribute, and also indexed by a full-text search engine.

E-mails can be searched using the command-line tool, and printed to the console as well as exported into RFC822-style flat files.